#!/bin/sh
# Launch simulation with INET NED path included so radio medium resolves.
set -e
cd "$(dirname "$0")"

INET_NED_PATH=$(inet4-config --ned-path 2>/dev/null || true)

# If INET_ROOT is set, prefer it explicitly
if [ -n "$INET_ROOT" ]; then
	[ -d "$INET_ROOT/src" ] && INET_NED_PATH="$INET_NED_PATH:$INET_ROOT/src"
fi

# Fallback to common INET install locations inside the container/host
for p in /opt/inet4/src /usr/lib/inet/src /usr/local/lib/inet/src; do
	[ -d "$p" ] && INET_NED_PATH="$INET_NED_PATH:$p"
done

NED_PATH=".:../src${INET_NED_PATH:+:$INET_NED_PATH}"
exec ../src/manet_adhoc -n "$NED_PATH" "$@"
# for shared lib, use: opp_run -l ../src/manet_adhoc -n "$NED_PATH" "$@"
